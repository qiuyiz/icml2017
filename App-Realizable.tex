
\section{Realizable Potentials}
\label{realizable}

\subsection{Activation-Potential Calculations}
First define the {\it dual} of a function $f: \R \to \R$ is defined to be 
%
\[ \widehat{f}(\rho) = E_{X,Y \sim N(\rho)}[f(X)f(Y)],\]
%
where $N(\rho)$ is the bivariate normal distribution with $X, Y$ unit variance and $\rho$ covariance. This is as in \cite{DanielyFS16}.
%
\begin{lemma}\label{rotLem}
Let $\mathcal{M} = S^{d-1}$ and $\sigma$ be our activation function, then $\widehat{\sigma}$ is the corresponding potential function.
\end{lemma}

\begin{proof}
If $u, v$ have norm 1 and if $X$ is a standard Gaussian in $\R^d$, then note that $X_1 = u^TX$ and $X_2 = v^TX$ are both standard Gaussian variables in $\R^1$ and the covariance is $E[X_1X_2] = u^Tv$. 

Therefore, the dual function of the activation gives us the potential function.
\begin{align*}
E_{X}[\sigma(u^TX)\sigma(v^TX)] & =
E_{X,Y \sim N(u^Tv)}[\sigma(X)\sigma(Y)] \\
& = \widehat{\sigma}(u^Tv).
\end{align*}
\end{proof}

By Lemma \ref{rotLem}, the calculations of the activation-potential
for the sign, ReLU, Hermite, exponential functions are given in
\cite{DanielyFS16}. For the Gaussian and Bessel activation functions,
we can calculate directly. In both case, we notice that we may write
the integral as a product of integrals in each dimension. Therefore,
it suffices to check the following 1-dimensional identities.
\begin{align*}
  & \int_{-\infty}^\infty
    \sqrt{2}e^{x^2/4}e^{-(x-\theta)^2}\sqrt{2}e^{x^2/4}e^{-(x-w)^2} \frac{1}{\sqrt{2\pi}} e^{-x^2/2}\, dx \\
  & \qquad = \sqrt{\frac{2}{\pi}}\int_{-\infty}^\infty
    e^{-(x-\theta)^2}e^{-(x-w)^2} \, dx = e^{-(\theta -w)^2/2}
\end{align*}
\begin{align*}
& \int_{-\infty}^\infty (\frac{2}{\pi})^{3/2}e^{x^2/2}K_0(|x-\theta|)K_0(|x-w|)  \frac{1}{\sqrt{2\pi}} e^{-x^2/2}\, dx \\
& \qquad 
= \int_{-\infty}^\infty \frac{2}{\pi^2}K_0(|x-\theta|)K_0(|x-w|) \, dx
  = e^{-|\theta -w|}
\end{align*}


The last equality follows by Fourier uniqueness and taking the Fourier transform of both sides, which are both equality $\sqrt{2/\pi}(\omega^2+1)^{-1}$. 


\subsection{Characterization Theorems}

\tranReal*

\begin{proof}
Let $h(x) = \FT^{-1}(\sqrt{\FT(f)})(x)$ and this is well-defined since the fourier transform was non-negative everywhere. Now, let $\sigma(x,w) = (2\pi)^{1/4}e^{x^2/4}h(x-w)$ and by assumption, it is bounded almost everywhere. Realizability follows by checking:
%
\begin{align*}
    E_{X \sim N}[\sigma(X,w)\sigma(X,\theta)]  &= \int_{\R^n} h(x-w)h(x-\theta) \, dx \\
    &= \int_{\R^n} h(x)h(x-(\theta-w)) \, dx \\
    &= \FT^{-1}(\FT(h\ast h)(\theta -w)) \\
    &= \FT^{-1}(\FT(h)^2(\theta - w)) \\
    &= \FT^{-1}(\FT(f)(\theta - w)) \\
    &= f(\theta - w) 
\end{align*}
\end{proof}




\rotReal*

\begin{proof}
By \ref{rotLem} and due to the orthogonality of hermite polynomials, if $f = \sum_i a_i h_i$, where $h_i(x)$ is the i-th Hermite polynomial, then
%
\[\widehat{f}(\rho) = \sum_{i} a_i^2 \rho^i\]

Therefore, any function with non-negative taylor coefficients is a valid potential function, with the corresponding activation function determined by the sum of hermite polynomials, and the sum is bounded almost everywhere by assumption.
\end{proof}

\subsection{Further Characterizations}

\begin{definition}
Let $\Phi$ be integrable or square integrable. Then, $\Phi$ is $\FT$-integrable if $\FT({\Phi}(\omega))$ is integrable, where $\FT$ is the standard Fourier transform.
\end{definition}

\begin{lemma}\label{sumReal}
Let $\mathcal{M} = \R^{d}$. If $\Phi_1, \Phi_2$ are $\FT$-integrable realizable potentials, then $\Phi_1 + \Phi_2$ is $\FT$-integrable realizable.
\end{lemma}

\begin{proof}
Since $\Phi_1, \Phi_2$ is $\FT$-integrable, then since the Fourier transform is linear, $\Phi_1+\Phi_2$ is also $\FT$-integrable. Since $\Phi_1, \Phi_2$ are realizable, they are positive definite and by Bochner's theorem, their Fourier transforms are non-negative. Therefore, we know $\FT(\Phi_1 + \Phi_2)\geq 0$ and $\sqrt{\FT(\Phi_1 + \Phi_2)}$ is defined and is square-integrable. By properties of the Fourier transform, $\FT^{-1}(\sqrt{\FT(\Phi_1 + \Phi_2)})$ exists and is also square-integrable, therefore bounded almost anywhere. Lastly, by Theorem \ref{thm:tranReal}, we conclude that $\Phi_1 + \Phi_2$ is realizable.
\end{proof}

\begin{lemma}\label{intReal}
Let $w(x) \geq 0$ be a positive weighting function such that $\int_a^b w(x) \, dx$ is bounded. If $\Phi_x$ is a parametrized family of $\FT$-integrable realizable potentials, then, $\int_a^b w(x) \Phi_x$ is $\FT$-integrable realizable.
\end{lemma}

\begin{proof}
Let $\Phi = \int_a^b w(x) \Phi_x$. From linearity of the Fourier transform and $\int_a^b w(x)\, dx$ is bounded, we know that $\Phi$ is $\FT$-integrable. Then, by the continuity of Fourier transform, we can argue similarly as the previous lemma.
\end{proof}



\begin{lemma}\label{baseConstruct}
Let $\mathcal{M} = \R^d$ for $d \equiv 3 \mod 4$. Then, for any $\epsilon, t > 0$, there exists a $\FT$-integrable realizable $\Phi$ such that for $t \geq r > \epsilon$, $\Phi^{(d-1)}(r) = t -r$ and $\Phi^{k}(r) = 0$ for $r > t$ for all $0 \leq k \leq d$.
\end{lemma}

\begin{proof}
First, consider a radial activation function $\sigma_t(x, \theta) = \bf{1}_{\|\theta - x\| \leq t/2}$, which is the indicator in the disk of radius $t/2$. This activation, when weighted correctly, gives rise to a realizable radial potential that is simply the convolution of $\sigma_t$ with itself, measuring the volume of the intersection of two spheres of radius $t$ centered at $\theta$ and $w$.
%
\[\Phi_t(\theta, w) = E_X[\sigma_t(X,\theta)\sigma_t(X,w)]\]
\[= \begin{cases}
C\int_{\|\theta - w\|/2}^{t/2} ((t/2)^2 - x^2)^{(d-1)/2} \, dx & \|\theta - w\| \leq t\\
0 & o.w.\\
\end{cases}\]
%
Therefore, as a function of $r=\|\theta - w \|$, we see that when $r \leq t$, $\Phi_t(r) = C\int_{r/2}^{t/2} ((t/2)^2-x^2)^{(d-1)/2} \, dx$ and $\Phi_t'(r) = -C'((t/2)^2-(r/2)^2)^{(d-1)/2}$. Since $d \equiv 3 \mod 4$, we notice that $\Phi_t'$ has a positive coefficient in the leading $r^{d-1}$ term and since it is a function of $r^2$, it has a zero $r^{d-2}$ term. Therefore, we can scale $\Phi_t$ such that 

\[\Phi_t^{(d-1)}(r) = \begin{cases}
r & r \leq t\\
0 & o.w. \\
\end{cases} \]

$\Phi_t$ is clearly realizable and we claim that it is $\FT$-integrable. First, $\Phi_t$ is integrable. Furthermore, $\sigma_t$ is integrable and square integrable, so its Fourier transform exists and by Parseval's, $\FT{\sigma_t}$ is square integrable. By the convolution properties of the Fourier transform, $\FT{\Phi_t} = \FT{\sigma_t}^2$, it follows that $\Phi_t$ is $\FT$-integrable.

Now, for any $\epsilon > 0$, let us construct our desired $\Phi$ by taking a positive sum of $\Phi_t$ and then appealing to Lemma \ref{intReal}. Consider

\[\Phi(r) = \int_{\epsilon}^{t} \frac{1}{x^2}\Phi_x(r) \, dx\]

First, note that the total weight $\int_\epsilon^t \frac{1}{x^2}$ is bounded. Then, when $r \geq t$, since $\Phi_x(r) = 0$ for $x \leq t$, we conclude that $\Phi^{(k)}(r) = 0$ for any $k$. Otherwise, for $\epsilon < r < t$, we can interchange limits by non-negativity to get

\[\Phi^{(d-1)}(r) = \int_{\epsilon}^r \frac{1}{x^2}\Phi_x^{(d-1)}(r) \, dx + \int_{r}^t \frac{1}{x^2} \Phi_x^{(d-1)}(r) \, dx\]

\[ = 0 + \int_r^t \frac{r}{x^2} \, dx = 1 -r/t \]

Scaling by $t$ gives our desired claim.
\end{proof}

\begin{lemma}\label{transConstruct}
Let $\mathcal{M} = \R^d$ for $d \equiv 3 \mod 4$ and let $\Phi(r)$ be a radial potential. Also, $\Phi^{(d)}(r) \leq 0$ and $\Phi^{(d+1)}(r)\geq 0$ for all $r > 0$ and $\lim_{r \to \infty} \Phi^{(k)}(r) = 0$ for all $0 \leq k \leq d$. 

Then, for any $\epsilon > 0$, there exists a $\FT$-integrable realizable potential $\overline{\Phi}$ $\Phi$ such that $\overline{\Phi}^{(k)}(r) = \Phi^{(k)}(r)$ for all $0 \leq k \leq d-1$ and $r \geq \epsilon$. 
\end{lemma}

\begin{proof}
By Lemma \ref{baseConstruct}, we can find $\Phi_t$ such that for $r \geq \epsilon$, we have $\Phi_t^{(d-1)}(r) = t - r $. Therefore, consider 

\[\overline{\Phi}(r) = \int_{\epsilon}^\infty \Phi^{(d+1)}(x) \Phi_x(r) \, dx\] 

Note that this is a positive sum with $\int_{\epsilon}^\infty \Phi^{(d+1)}(x) \, dx = -\Phi^{(d)}(\epsilon) < \infty$. By the non-negativity of $-\Phi^{(d)}_x$, we can interchange limits to get

\[\overline{\Phi}^{(d-1)}(r) = \int_{\epsilon}^\infty  \Phi^{(d+1)}(x) (\Phi_x^{(d-1)}(r)) \, dx\] 

\[ = \int_r^\infty \Phi^{(d+1)}(x) \int_r^x 1 \, dy \,dx \]

\[= \int_r^\infty \int_y^\infty \Phi^{(d+1)}(x) \, dx \, dy = \int_r^\infty  -\Phi^{(d)}(y) \, dy\]

\[ = \Phi^{(d-1)}(r)\]

Now, since $\overline{\Phi}^{(d-1)}(r) = \Phi^{(d-1)}(r)$ for $r\geq \epsilon$ and $\lim_{r\to\infty} \overline{\Phi}^{k}(r) = \lim_{r\to\infty} {\Phi}^{k}(r) = 0$ for $0 \leq k \leq d-1$, repeated integration gives us our claim.
\end{proof}

\begin{theorem}\label{almostHarmReal}
Let $\mathcal{M} = \R^d$ for $d \equiv 3 \mod 4$. Then, for any $\epsilon > 0$, we can construct a radial potential $\Phi_\epsilon(r)$ that is $1$-harmonic when $r \geq \epsilon$.
\end{theorem}

\begin{proof}
Consider a potential of the form $\Phi(r) = p(r)e^{-r}/r^{d-2}$. We claim that there exists a polynomial $p$ of degree $k = (d-3)/2$ with non-negative coefficients and $p(0) = 1$ such that $\Phi$ is $1$-harmonic.

When $d = 3$, it is easy to check that $\Phi(r) = e^{-r}/r$ is our desired potential. Otherwise, by our formula for the radial Laplacian in $d$ dimensions, we want to solve the following differential equation:

\[\Delta \Phi =  \frac{1}{r^{d-1}} \frac{\partial}{\partial r} (r^{d-1} \frac{\partial \Phi}{\partial r}) = \Phi\]

Solving this gives us the following second-order differential equation on $p$

\[rp'' - (d+2r-3)p' +(d-3)p = 0\]

Let us write $p(r) = \sum_{i=0}^k a_i x^i$. Then, substituting into our differential equation gives us the following equations by setting each coefficient of $x^i$ to zero:

$x^0:$ $a_0 = a_1$,

$x^i$:  $a_{i-1}(d-3 - 2(i-1)) = a_i (i(d-3 - i-1))$

$x^k:$ $-2k +d-3 = 0$

Note that for $i = 1$, this becomes $a_0 = a_1$, which is already satisfied. Thus, setting $a_0 = 1$ and running the recurrence gives us our desired polynomial. Note that the recurrence is valid and produces positive coefficients since $i < k  = (d-3)/2$. Therefore, our claim follows and $\Phi$ is $1$-harmonic.

Lastly, we assert that $\Phi^{(j)}(r)$ is non-negative for $j$ even and non-positive for $j$ odd. Our second claim is that if $\Phi$ is of the form $\Phi(r) = p(r) e^{-r}/r^{l}$ for some $p$ of degree $k < l$ and $p$ has non-negative coefficients, then $\Phi'(r) = - q(r) e^{-r}/r^{l+1}$ for some $q$ of degree $k+1$ with non-negative coefficients. 

It suffices to prove our second claim. Differentiating $\Phi$ gives:

\[\Phi' = \frac{e^{-r}}{r^{l+1}} (rp'(r) - (l + r)p(r))\]

It is clear that if $p$ has degree $k$, then $q(r) = (l+r)p(r) - rp'(r)$ has degree $k+1$, so it suffices to show that it has non-negative coefficients. Let $p_0,..., p_k$ be the non-negative coefficients of $p$. Then, by our formula, we see that 

$q_0 = l p_0$

$q_i = lp_i - ip_i + p_{i-1} = (l-i)p_i + p_{i-1}$ 

$q_{k+1} = p_k$

Since $i \leq k < l$, we conclude that $q$ has non-negative coefficients. Finally, our assertion follows with induction since $\Phi^{(0)}(r)$ is non-negative and has our desired form with $k = (d-3)/2 < d-2$. By Lemma \ref{transConstruct}, our theorem follows.
\end{proof}

\begin{theorem}
Let $\mathcal{M} = \R^d$ for $d \equiv 3 \mod 4$ and let $L$ be as in \eqref{errLoss}. For any $\epsilon > 0$, we can find a realizable potential $\Phi$ such that if $\boldsymbol{(a,\theta)}$ is a local minima of $L$, then for all $i$, either 1) there exists $S \subseteq [k]$ such that $i\in S$ and $\sum_{i \in S} a_i \sigma(\theta_i, x) = 0$ or 2) there exists $j$ such that $\|\theta_i - w_j\| < \epsilon$.
\end{theorem}

\begin{proof}
 The proof is similar to Theorem \ref{EigStrict}. Let $\Phi$ be the realizable potential in \ref{almostHarmReal} such that $\Phi(r)$ is 1-harmonic when $r \geq \epsilon/k$. And let $\boldsymbol{a,\theta}$ be a local minima of $L$. Assume there is a non-empty subset $S \subseteq [k]$ such that for each $i \in S$, $\|w_j - \theta_i\|\geq \epsilon/k$ for all $j$, and $\|\theta_i - \theta_j\| \leq \epsilon/k$ for all $j\in [k]/S$. WLOG, let $S = \{1,\dots,l\}$. 
  
We consider changing all
$\theta_1, \ldots, \theta_{l}$ by the same $v$ and define 
%
\[H({\bf a}, v) = L({\bf a},\theta_1+v,...,\theta_l+v, \theta_{l+1}
\ldots, \theta_k).\]

The optimality conditions on ${\bf a}$ are 
\begin{align*}
0 = \pd{H}{a_i} = 2a_i  + 2\sum_{j\neq i} a_j \Phi(\theta_i,\theta_j)
  + 2\sum_{j=1}^k b_j \Phi(\theta_i,w_j).
\end{align*}
%
Next, since $\Phi(r)$ is $1$-harmonic for $r \geq \epsilon/k$, we may differentiate as $\theta_i \neq w_j$ and compute the Laplacian as 
\begin{align*}
\Delta_v H & = \sum_{i=1}^l a_i \left(2\sum_{j=1}^k b_j
  \Phi(\theta_i, w_j) + 2\sum_{j=l+1}^k a_j
  \Phi(\theta_i, \theta_j)\right) \\
& = \sum_{i=1}^l a_i \left(-2a_i\Phi(\theta_i, \theta_i) - 2
  \sum_{j = 1, j\neq i}^l  a_j \Phi(\theta_i,\theta_j)\right) \\
& = -2\left(\sum_{i=1}^l a_i^2 \Phi(\theta_i, \theta_i)
+\sum_{i \neq j}^l a_i a_j \Phi(\theta_i, \theta_j)\right) \\
&= -2\expt\left[\left( \sum_{i=1}^l a_i \sigma(\theta_i,X)\right)^2\right]
\end{align*} 
%
If $f(x) = \sum_{i=1}^l a_i\sigma(\theta_i, x) = 0$, then we satisfy condition 1. Otherwise, we conclude that the Laplacian is
strictly negative, so we are not at a local minimum.  

Therefore, it must be the case that there exists ${j_1},\cdots {j_q}$ such that $\|\theta_i - \theta_{j_1} \| < \epsilon/k$ and
$\|\theta_{j_{i}} - \theta_{j_{i+1}}\| < \epsilon/k$, and
$\|\theta_{j_q}- w_j\| <\epsilon/k$ for some $w_j$. So, there exists $j$, such that $\|\theta_i - w_j\| < \epsilon$. 


\end{proof}

